<?xml version="1.0" encoding="utf-8"?>
<project-config
  xmlns="http://www.pustefix-framework.org/2008/namespace/project-config"
  xmlns:jee="http://java.sun.com/xml/ns/javaee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
>
  
  <project>
    <name>editor2</name>
    <description>Pustefix CMS</description>
    <choose>
      <when test="$mode = 'prod'">
        <enabled>false</enabled>
      </when>
    </choose>
  </project>
  
  <editor>
    <enabled>false</enabled>
    <location>http://cms.${fqdn}/</location>
  </editor>
  
  <xml-generator>
    <config-file>pfixroot:/conf/depend.xml</config-file>
  </xml-generator>
  
  <http-server>
    
    <choose>
      <when test="pfx:isSet('__antprop_pustefix.editor.address')">
        <http-port>
          <address>${__antprop_pustefix.editor.address}</address>
        </http-port>
      </when>
      <otherwise>
        <http-port>
          <address>${fqdn}</address>
        </http-port>
      </otherwise>
    </choose>
    
    <choose>
      <when test="pfx:isSet('__antprop_pustefix.editor.servername')">
        <server-name>${__antprop_pustefix.editor.servername}</server-name>
      </when>
      <otherwise>
        <server-name>cms.${fqdn}</server-name>
      </otherwise>
    </choose>
    
    <choose>
      <when test="pfx:isSet('__antprop_pustefix.editor.serveralias')">
        <server-alias>${__antprop_pustefix.editor.serveralias}</server-alias>
      </when>
      <otherwise>
        <server-alias>cms.${machine}</server-alias>
      </otherwise>
    </choose>
    
  </http-server>
  
  <application>
    
    <docroot-path>pfixroot:/docroot</docroot-path>
    <default-path>/xml/edit</default-path>
    
    <context-xml-service>
      <path>/xml/edit</path>
      <config-file>pfixroot:/conf/edit.conf.xml</config-file>
    </context-xml-service>
    
    <static>
      <path>img</path>
    </static>
    
    <web-xml>
      <jee:web-app>
        <jee:filter>
          <jee:filter-name>editor-session-cookie-filter</jee:filter-name>
          <jee:filter-class>de.schlund.pfixcore.editor2.frontend.util.SessionCookieFilter</jee:filter-class>
        </jee:filter>
        
        <jee:filter-mapping>
          <jee:filter-name>editor-session-cookie-filter</jee:filter-name>
          <jee:url-pattern>/xml/edit/*</jee:url-pattern>
        </jee:filter-mapping>
      </jee:web-app>
    </web-xml>
    
  </application>
  
</project-config>
