<?xml version="1.0"?>
<configuration
  xmlns="http://www.marsching.com/2008/flexiparse/configurationNS"
  xmlns:p="http://www.pustefix-framework.org/2009/namespace/module-config"
>
  
  <!-- Handle context xml configuration -->
  
  <handler class="org.pustefixframework.config.module.parser.PustefixContextXMLRequestHandlerParsingHandler">
    <match>/p:pustefix-module/p:application//p:context-xml-service</match>
  </handler>
  
  <!--  Handle xml-generator configuration -->
  
  <handler class="org.pustefixframework.config.module.parser.XMLGeneratorParsingHandler">
    <match>/p:pustefix-module//p:xml-generator</match>
  </handler>
  
  <!--  Handle view extensions and extension points -->
  
  <handler class="org.pustefixframework.xmlgenerator.view.ViewExtensionsParsingHandler" run-order="end">
    <match>/p:pustefix-module/p:application</match>
  </handler>
  
  <!-- Handle direct output configuration -->
  
  <handler class="org.pustefixframework.config.module.parser.PustefixContextDirectOutputRequestHandlerParsingHandler">
    <match>/p:pustefix-module/p:application//p:direct-output-service</match>
  </handler>
  
  <!-- Handle static resources -->
  
  <handler class="org.pustefixframework.config.application.parser.DefaultStaticResourceExtensionParsingHandler" run-order="end">
    <match>/p:pustefix-module/p:application/p:static</match>
  </handler>
  
  <handler class="org.pustefixframework.config.application.parser.StaticResourceExtensionParsingHandler" run-order="end">
    <match>/p:pustefix-module/p:application/p:extension[@type='application.static']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.application.parser.StaticResourceExtensionPointParsingHandler">
    <match>/p:pustefix-module/p:application/p:extension[@type='application.static']/p:extension-point[@type='application.static']</match>
    <match>/p:pustefix-module/p:application/p:static/p:extension-point[@type='application.static']</match>
  </handler>
  
  <!--  Handle dynamic include configuration -->
  
  <handler class="org.pustefixframework.config.module.parser.DynamicIncludeInfoParsingHandler">
    <match>/p:pustefix-module/p:dynamic-includes</match>
  </handler>
  
  <!-- Make Pustefix context available in module's application context -->
  
  <handler class="org.pustefixframework.config.module.parser.RegisterContextParsingHandler">
    <match>/p:pustefix-module</match>
  </handler>
  
  <!-- Properties support (unused at the moment) -->
  
  <handler class="org.pustefixframework.config.generic.PropertiesParsingHandler">
    <match>/p:pustefix-module/p:properties</match>
  </handler>
  
  <handler class="org.pustefixframework.config.generic.PropertyParsingHandler">
    <match>/p:pustefix-module/p:properties//p:prop</match>
  </handler>
  
<!--
  <handler class="org.pustefixframework.config.application.parser.RegisterProjectPropertiesParsingHandler" run-order="end">
    <preceding-handler>org.pustefixframework.config.generic.PropertiesParsingHandler</preceding-handler>
    <match>/p:pustefix-module/p:properties</match>
  </handler>
-->
  
  
  <!-- Customization support -->
  
  <handler id="org.pustefixframework.config.customization.WhenParsingHandler" class="org.pustefixframework.config.customization.CustomizationWhenParsingHandler">
    <match>/p:pustefix-module/p:choose/p:when</match>
    <match>/p:pustefix-module/p:properties/p:choose/p:when</match>
  </handler>
  
  <handler id="org.pustefixframework.config.customization.OtherwiseParsingHandler" class="org.pustefixframework.config.customization.CustomizationOtherwiseParsingHandler">
    <match>/p:pustefix-module/p:choose/p:otherwise</match>
    <match>/p:pustefix-module/p:properties/p:choose/p:otherwise</match>
  </handler>
  
</configuration>
