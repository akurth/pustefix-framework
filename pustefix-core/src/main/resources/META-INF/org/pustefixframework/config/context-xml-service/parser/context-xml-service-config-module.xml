<?xml version="1.0"?>
<configuration
  xmlns="http://www.marsching.com/2008/flexiparse/configurationNS"
  xmlns:c="http://www.pustefix-framework.org/2008/namespace/context-xml-service-config"
  xmlns:xi="http://www.w3.org/2001/XInclude"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="
    http://www.marsching.com/2008/flexiparse/configurationNS http://www.marsching.com/2008/flexiparse/flexiparse-configuration.xsd
  "
>
  
  <!-- Root -->
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ContextXMLDummyParsingHandler">
    <match>/c:context-xml-service-config</match>
  </handler>
  
  
  <!-- Global -->
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.DefaultStateParsingHandler">
    <match>/c:context-xml-service-config/c:global-config/c:defaultstate</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.DefaultIHandlerStateParsingHandler">
    <match>/c:context-xml-service-config/c:global-config/c:defaultihandlerstate</match>
  </handler>
  
  
  <!-- Page flows -->
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflow']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowVariantExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflowvariant']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowStepExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.flowstep']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowParsingHandler" run-order="both">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflow']/c:pageflow</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowDummyParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflowvariant']/c:pageflow</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflow']/c:extension-point[@type='context.pageflow']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowVariantExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflow']/c:pageflow/c:extension-point[@type='context.pageflowvariant']</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflowvariant']/c:pageflow/c:extension-point[@type='context.pageflowvariant']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowVariantParsingHandler" run-order="both">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflow']/c:pageflow/c:variant</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflowvariant']/c:pageflow/c:variant</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowStepParsingHandler" run-order="both">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflow']/c:pageflow//c:flowstep</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflowvariant']/c:pageflow//c:flowstep</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.flowstep']/c:flowstep</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowStepExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflow']/c:pageflow//c:extension-point[@type='context.flowstep']</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflowvariant']/c:pageflow//c:extension-point[@type='context.flowstep']</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.flowstep']/c:extension-point[@type='context.flowstep']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowStepOnContinueParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflow']/c:pageflow//c:flowstep/c:oncontinue</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflowvariant']/c:pageflow//c:flowstep/c:oncontinue</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.flowstep']/c:flowstep/c:oncontinue</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowStepConditionParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflow']/c:pageflow//c:flowstep/c:oncontinue/c:when</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflowvariant']/c:pageflow//c:flowstep/c:oncontinue/c:when</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.flowstep']/c:flowstep/c:oncontinue/c:when</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageFlowStepActionParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflow']/c:pageflow//c:flowstep/c:oncontinue/c:when/c:action</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pageflowvariant']/c:pageflow//c:flowstep/c:oncontinue/c:when/c:action</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.flowstep']/c:flowstep/c:oncontinue/c:when/c:action</match>
  </handler>
  
  
  <!-- Pages -->
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestConfigExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestConfigVariantExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequestvariant']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.SSLParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest//c:force-ssl</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequestvariant']/c:pagerequest//c:force-ssl</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ConditionParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest/c:authconstraint//c:and</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest/c:authconstraint//c:or</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest/c:authconstraint//c:not</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest/c:authconstraint//c:condition</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest/c:authconstraint//c:authconstraint</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest/c:authconstraint//c:hasrole</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/*[self::c:default or self::c:variant]/c:authconstraint//c:and</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/*[self::c:default or self::c:variant]/c:authconstraint//c:or</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/*[self::c:default or self::c:variant]/c:authconstraint//c:not</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/*[self::c:default or self::c:variant]/c:authconstraint//c:condition</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/*[self::c:default or self::c:variant]/c:authconstraint//c:authconstraint</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/*[self::c:default or self::c:variant]/c:authconstraint//c:hasrole</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestConfigExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:extension-point[@type='context.pagerequest']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestConfigVariantExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/extension-point[@type='context.pagerequestvariant']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestParsingHandler" run-order="both">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest[not(child::c:variant) and not (child::c:default)]</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest/c:default</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/c:variant</match>
  </handler>

  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestDefaultFlowParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:defaultflow</match>
  </handler>

  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestStateParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:state</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestInputParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:input</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestInputWrapperParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:input/c:wrapper</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.wrapper']/c:wrapper</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestIWrapperConfigExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:input/c:extension-point[@type='context.wrapper']</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.wrapper']/c:extension-point[@type='context.wrapper']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestIWrapperConfigExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.wrapper']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestOutputResourceExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.resource']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestOutputResourceParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:output/c:resource</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.resource']/c:resource</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestOutputResourceExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:output/c:extension-point[@type='context.resource']</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.resource']/c:extension-point[@type='context.resource']</match>
  </handler>
  
  <!-- Page Actions -->
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ProcessActionParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:process/c:action</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.action']/c:action</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ProcessActionWrapperParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:process/c:action/c:submit/c:wrapper</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:process/c:action/c:retrieve/c:wrapper</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.action']/c:action/c:submit/c:wrapper</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.action']/c:action/c:retrieve/c:wrapper</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestProcessActionConfigExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:process/c:extension-point[@type='context.action']</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.action']/c:extension-point[@type='context.action']</match>
  </handler>

  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestProcessActionConfigExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.action']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.PageRequestRegisterPropertiesParsingHandler" run-order="end">
    <preceding-handler>org.pustefixframework.config.generic.PropertiesParsingHandler</preceding-handler>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:properties</match>
  </handler>
  
  
  <!-- Context interceptors -->
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ContextInterceptorExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.interceptor']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ContextInterceptorParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.interceptor']/c:interceptor</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ContextInterceptorExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.interceptor']//c:extension-point[@type='context.interceptor']</match>
  </handler>
  
  
  <!-- Scripted flows -->
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ScriptedFlowParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.scriptedflow']/c:scriptedflow</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ScriptedFlowExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.scriptedflow']/c:extension-point[@type='context.scriptedflow']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ScriptedFlowExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.scriptedflow']</match>
  </handler>
  
  <!-- Roles -->
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.RoleParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.role']/c:role</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.RoleExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.role']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.RoleExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.role']/c:extension-point[@type='context.role']</match>
  </handler>
  
  <!-- Authconstraints -->
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.AuthConstraintExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.AuthConstraintExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:extension-point[@type='context.authconstraint']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.AuthConstraintExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.AuthConstraintParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:authconstraint</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/c:authconstraint</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/*[self::c:default or self::c:variant]/c:authconstraint</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.AuthConstraintExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:extension-point[@type='context.authconstraint']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.AuthConstraintExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.ConditionParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:authconstraint//c:and</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:authconstraint//c:or</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:authconstraint//c:not</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:authconstraint//c:condition</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:authconstraint//c:authconstraint</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:authconstraint//c:hasrole</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:pagerequest/c:authconstraint//c:and</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:pagerequest/c:authconstraint//c:or</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:pagerequest/c:authconstraint//c:not</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:pagerequest/c:authconstraint//c:condition</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:pagerequest/c:authconstraint//c:authconstraint</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.authconstraint']/c:pagerequest/c:authconstraint//c:hasrole</match>
  </handler>
  
  
  <!-- JSON output object -->
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.JSONOutputResourceParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.jsonoutput']/c:resource</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.JSONOutputResourceExtensionPointParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.jsonoutput']//c:extension-point[@type='context.jsonoutput']</match>
  </handler>
  
  <handler class="org.pustefixframework.config.contextxmlservice.parser.JSONOutputResourceExtensionParsingHandler" run-order="end">
    <match>/c:context-xml-service-config/c:extension[@type='context.jsonoutput']</match>
  </handler>
  
  
  <!-- Properties -->
  
  <handler class="org.pustefixframework.config.generic.PropertiesParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:properties</match>
  </handler>
  
  <handler class="org.pustefixframework.config.generic.PropertyParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:properties//c:prop</match>
  </handler>
  
  
  <!-- Customization -->
  
  <handler id="org.pustefixframework.config.customization.WhenParsingHandler" class="org.pustefixframework.config.customization.CustomizationWhenParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:properties/c:choose/c:when</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/c:choose/c:when</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest/c:default/c:choose/c:when</match>
  </handler>
  
  <handler id="org.pustefixframework.config.customization.OtherwiseParsingHandler" class="org.pustefixframework.config.customization.CustomizationOtherwiseParsingHandler">
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest//c:properties/c:choose/c:otherwise</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest' or @type='context.pagerequestvariant']/c:pagerequest/c:choose/c:otherwise</match>
    <match>/c:context-xml-service-config/c:extension[@type='context.pagerequest']/c:pagerequest/c:default/c:choose/c:otherwise</match>
  </handler>
  
</configuration>
