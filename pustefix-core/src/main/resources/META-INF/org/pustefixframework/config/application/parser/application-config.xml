<?xml version="1.0"?>
<configuration
  xmlns="http://www.marsching.com/2008/flexiparse/configurationNS"
  xmlns:p="http://www.pustefix-framework.org/2009/namespace/application-config"
>
  
  <handler class="org.pustefixframework.config.application.parser.ProjectInfoParsingHandler">
    <match>/p:pustefix-application/p:project</match>
  </handler>
  
  <!-- Adds handler mapping bean -->
  <handler class="org.pustefixframework.config.application.parser.PustefixHandlerMappingParsingHandler">
    <match>/p:pustefix-application/p:application</match>
  </handler>
  
  <!-- Creates request handler for static resources -->
  <handler class="org.pustefixframework.config.application.parser.DocrootRequestHandlerParsingHandler">
    <match>/p:pustefix-application/p:application</match>
  </handler>
  
  <!-- Adds the SessionCleaner bean -->
  <handler class="org.pustefixframework.config.application.parser.SessionCleanerParsingHandler">
    <match>/p:pustefix-application/p:application//p:context-xml-service</match>
    <match>/p:pustefix-application/p:application//p:context-xml-service//p:session-cleaner-timeout</match>
  </handler>
  
 <!-- Creates dereferer request handler -->
  <handler class="org.pustefixframework.config.application.parser.DerefRequestHandlerParsingHandler">
    <match>/p:pustefix-application/p:application</match>
    <match>/p:pustefix-application/p:application/p:deref-service</match>
  </handler>
  
  <!-- Creates ExceptionProcessors -->
  <handler class="org.pustefixframework.config.application.parser.ExceptionProcessingParsingHandler">
    <match>/p:pustefix-application/p:application</match>
    <match>/p:pustefix-application/p:application//p:exception-processing</match>
  </handler>
  
  <!-- Adds SessionAdmin bean -->
  <handler class="org.pustefixframework.config.application.parser.SessionAdminParsingHandler">
    <match>/p:pustefix-application/p:application</match>
  </handler>
  
  <!-- Adds WebappAdmin bean -->
  <handler class="org.pustefixframework.config.application.parser.WebappAdminParsingHandler">
    <match>/p:pustefix-application//p:application</match>
  </handler>
  
  <!-- Creates PerfLogging bean -->
  <handler class="org.pustefixframework.config.application.parser.PerfLoggingParsingHandler">
    <match>/p:pustefix-application//p:perflogging</match>
  </handler>
  
  <!-- Creates AuthAdmin bean -->
  <handler class="org.pustefixframework.config.application.parser.AuthAdminParsingHandler">
    <match>/p:pustefix-application//p:authadmin</match>
  </handler>
  
  <!-- Creates TestRecording bean -->
  <handler class="org.pustefixframework.config.application.parser.TestRecordingParsingHandler">
    <match>/p:pustefix-application//p:testrecording</match>
  </handler>
  
  <!-- Reads path to depend.xml file -->
  <handler class="org.pustefixframework.config.application.parser.XMLGeneratorInfoParsingHandler">
    <match>/p:pustefix-application/p:xml-generator</match>
    <match>/p:pustefix-application/p:xml-generator//p:config-file</match>
    <match>/p:pustefix-application/p:xml-generator//p:check-modtime</match>
    <match>/p:pustefix-application/p:xml-generator//p:include-cache</match>
    <match>/p:pustefix-application/p:xml-generator//p:target-cache</match>
    <match>/p:pustefix-application/p:xml-generator//p:cache-statistic</match>
  </handler>
  
  <!-- Creates context xml request handler -->
  <handler class="org.pustefixframework.config.application.parser.PustefixContextXMLRequestHandlerParsingHandler">
    <match>/p:pustefix-application/p:application//p:context-xml-service</match>
  </handler>

  <!-- Creates context xml request handler -->
  <handler class="org.pustefixframework.config.application.parser.PustefixContextDirectOutputRequestHandlerParsingHandler">
    <match>/p:pustefix-application/p:application//p:direct-output-service</match>
  </handler>
  
  <!-- Saves path with editor location -->
  <handler class="org.pustefixframework.config.application.parser.EditorLocationParsingHandler">
    <match>//p:pustefix-application/p:editor//p:location</match>
  </handler>

  <!-- Saves editor info -->
  <handler class="org.pustefixframework.config.application.parser.EditorInfoParsingHandler">
    <match>/p:pustefix-application/p:editor//p:enabled</match>
  </handler>

  <handler class="org.pustefixframework.config.generic.PropertiesParsingHandler">
    <match>/p:pustefix-application/p:properties</match>
  </handler>
  
  <handler class="org.pustefixframework.config.generic.PropertyParsingHandler">
    <match>/p:pustefix-application/p:properties//p:prop</match>
  </handler>

  <handler class="org.pustefixframework.config.application.parser.RegisterProjectPropertiesParsingHandler" run-order="end">
    <preceding-handler>org.pustefixframework.config.generic.PropertiesParsingHandler</preceding-handler>
    <match>/p:pustefix-application/p:properties</match>
  </handler>
  
  
  <handler id="org.pustefixframework.config.customization.WhenParsingHandler" class="org.pustefixframework.config.customization.CustomizationWhenParsingHandler">
    <match>/p:pustefix-application/p:choose/p:when</match>
    <match>/p:pustefix-application/p:application/p:choose/p:when</match>
    <match>/p:pustefix-application/p:xml-generator/p:choose/p:when</match>
    <match>/p:pustefix-application//p:context-xml-service/p:choose/p:when[p:session-cleaner-timeout]</match>
    <match>/p:pustefix-application/p:editor/p:choose/p:when</match>
    <match>/p:pustefix-application/p:properties/p:choose/p:when</match>
  </handler>
  
  <handler id="org.pustefixframework.config.customization.OtherwiseParsingHandler" class="org.pustefixframework.config.customization.CustomizationOtherwiseParsingHandler">
    <match>/p:pustefix-application/p:choose/p:otherwise</match>
    <match>/p:pustefix-application/p:application/p:choose/p:otherwise</match>
    <match>/p:pustefix-application/p:xml-generator/p:choose/p:otherwise</match>
    <match>/p:pustefix-application//p:context-xml-service/p:choose/p:otherwise[p:session-cleaner-timeout]</match>
    <match>/p:pustefix-application/p:editor/p:choose/p:otherwise</match>
    <match>/p:pustefix-application/p:properties/p:choose/p:otherwise</match>
  </handler>
  
</configuration>
