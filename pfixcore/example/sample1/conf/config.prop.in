<?xml version="1.0" encoding="ISO-8859-1"?>
<contextxmlserver xmlns="http://pustefix.sourceforge.net/properties200401" xmlns:cus="http://www.schlund.de/pustefix/customize" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://pustefix.sourceforge.net/properties200401 http://pustefix.sourceforge.net/properties200401.xsd" version="1.0">
  
  <servletinfo depend="sample1/conf/depend.xml" name="pfixcore_project:sample1::servlet:config">
    <editmode allow="true"/>
    <adminmode watch="default" page="admin"/>
  </servletinfo>
  
  <context defaultflow="OrderFlow">
    <resource class="de.schlund.pfixcore.example.ContextCounterImpl">
      <implements class="de.schlund.pfixcore.example.ContextCounter"/>
      <properties>
        <prop name="foo">bar</prop>
        <prop name="baz">snafu</prop>
      </properties>
    </resource>
    
    <resource class="de.schlund.pfixcore.example.ContextTShirtImpl">
      <implements class="de.schlund.pfixcore.example.ContextTShirt"/>
    </resource>
    
    <resource class="de.schlund.pfixcore.example.ContextTrouserImpl">
      <implements class="de.schlund.pfixcore.example.ContextTrouser"/>
    </resource>
    
    <resource class="de.schlund.pfixcore.example.ContextAdultInfoImpl">
      <implements class="de.schlund.pfixcore.example.ContextAdultInfo"/>
    </resource>
    
    <resource class="de.schlund.pfixcore.example.ContextTogglePicImpl">
      <implements class="de.schlund.pfixcore.example.ContextTogglePic"/>
    </resource>
  </context>
  
  <!-- <pageflow name="OrderFlow" stopnext="true"> -->
  <pageflow name="OrderFlow">
    <flowstep name="home"/>
    <flowstep name="order">
      <oncontinue applyall="true">
        <when test="/formresult/counter/@counter = 2">
          <action type="jumpto" page="test" pageflow="OrderFlow"/>
        </when>
        <when>
          <action type="de.schlund.pfixcore.example.MsgFlowStepAction" text="**** Hi Ho ****"/>
        </when>
      </oncontinue>
    </flowstep>
    <flowstep name="overview"/>
  </pageflow>
  
  <!-- *** PageRequests and associated properties *** -->
  
  <pagerequest name="admin"/>
  
  <pagerequest name="test"/>
  
  <pagerequest name="home">
    <input>
      <interface prefix="info" class="de.schlund.pfixcore.example.iwrapper.AdultInfo"/>
    </input>
  </pagerequest>
  
  <pagerequest name="order">
    <ssl force="true" modes="prod"/>
    <input>
      <interface prefix="shirt" class="de.schlund.pfixcore.example.iwrapper.TShirt"/>
      <interface prefix="counter" class="de.schlund.pfixcore.example.iwrapper.Counter"/>
      <interface prefix="cinput" class="de.schlund.pfixcore.example.iwrapper.CounterInput" alwaysretrieve="true"/>
      <interface prefix="trouser" class="de.schlund.pfixcore.example.iwrapper.Trouser"/>
      <interface prefix="pic" class="de.schlund.pfixcore.example.iwrapper.TogglePic"/>
    </input>
    <output>
      <resource node="counter" class="de.schlund.pfixcore.example.ContextCounter"/>
      <resource node="togglepic" class="de.schlund.pfixcore.example.ContextTogglePic"/>
    </output>
    <!-- The next properties can be set additonally for DefaultIWrapperState and descendants (default is shown) -->
    <!-- <finalizer class="de.schlund.pfixcore.workflow.app.ResdocSimpleFinalizer"/> -->
    <!-- <param name="forcegroupdisplay">false</param> -->
    
    <properties>
      <prop name="group.01-Shirt">shirt counter cinput pic</prop>
      <prop name="group.02-Trouser">trouser</prop>
    </properties>
  </pagerequest>
  
  <!-- Here we have a simple state which extends StaticState so we can render ContextResources. -->
  <!-- It does the isAccessible() part on it's own. -->
  <pagerequest name="overview">
    <ssl force="true" modes="prod"/>
    <state class="de.schlund.pfixcore.example.OverviewState"/>
    <output>
      <resource node="adultinfo" class="de.schlund.pfixcore.example.ContextAdultInfo"/>
      <resource node="tshirt" class="de.schlund.pfixcore.example.ContextTShirt"/>
      <resource node="trouser" class="de.schlund.pfixcore.example.ContextTrouser"/>
    </output>
  </pagerequest>
  
  <pagerequest name="gencss" nostore="true">
    <properties>
      <prop name="mimetype">text/css</prop>
      <choose>
        <test mode="prod">
          <prop name="responseheader.Cache-Control">max-age=3600</prop>
        </test>
        <test>
          <prop name="responseheader.Cache-Control">max-age=60</prop>
        </test>
      </choose>
    </properties>
  </pagerequest>

  <properties>
    <!-- *** some additional properties needed for this application *** -->
    <!-- <prop name="interfacelogging">sample1/log</prop> -->
    <prop name="contexttshirt.feature.0">Waterproof</prop>
    <prop name="contexttshirt.feature.1">Extra warm</prop>
    <prop name="contexttshirt.feature.2">Windproof</prop>
    <prop name="contexttrouser.feature.0">Waterproof</prop>
    <prop name="contexttrouser.feature.1">Extra warm</prop>
    <prop name="contexttrouser.feature.2">Windproof</prop>
  </properties>
</contextxmlserver>
