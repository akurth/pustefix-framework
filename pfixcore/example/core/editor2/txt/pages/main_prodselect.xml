<?xml version="1.0" encoding="ISO-8859-1"?>
<include_parts xmlns:ixsl="http://www.w3.org/1999/XSL/Transform" xmlns:pfx="http://www.schlund.de/pustefix/core">
  
  <part name="logoutbutton">
    <product name="default">
      <lang name="default">
        <pfx:button page="logout" jumptopage="prodselect" target="_top">
          <pfx:argument name="logout.Do">1</pfx:argument>Logout</pfx:button>
      </lang>
    </product>
  </part>

  <part name="content">
    <product name="default">
      <lang name="default">
        <div class="info">
        <h1>Hello, <ixsl:value-of select="/formresult/session/user/@fullname"/>.</h1>

        <!-- TODO Add support for locking logins -->
        <ixsl:if test="/formresult/cr_editorsession/@loginallowed = &apos;false&apos;">
          <h2>New logins are currently NOT allowed!</h2>
        </ixsl:if>
        </div>

        <div class="box">
          <h1>Projects</h1>
          <ul class="jobs">
            <ixsl:for-each select="/formresult/projects/project">
              <ixsl:sort select="./@name"/>
              <li>
                <pfx:button normalclass="editor_submit" page="prodselect" mode="force">
                  <!--
                  <pfx:command name="SELWRP">prodsel</pfx:command>
                  <pfx:argument name="__pageflow">Editor</pfx:argument>
                  -->
                  <pfx:argument name="selectproject.ProjectName"><ixsl:value-of select="./@name"/></pfx:argument>
                  <ixsl:value-of select="./@comment"/>
                </pfx:button>
              </li>
            </ixsl:for-each>
          </ul>
        </div>

        <div class="box">
          <h1>Managment</h1>
        
          <ul class="jobs">
            <li><pfx:button normalclass="editor_submit" page="sessionmanager">List running sessions</pfx:button></li>
            <li><pfx:button normalclass="editor_submit" page="lockmanager">List active locks</pfx:button></li>
            <li>
            <pfx:button mode="force" normalclass="editor_submit" page="prodselect" pageflow="EditLoginUser" target="_top">
              <pfx:command name="SELWRP">edituser</pfx:command>
              <pfx:argument name="edituser.User"><ixsl:value-of select="/formresult/cr_editorsession/user/@id"/></pfx:argument>
              Change your data
            </pfx:button>
            </li>
          </ul>
        </div>

        <ixsl:if test="/formresult/cr_editorsession/user/permissions/global/@admin = 'true'">
          <div class="box">
            <h1>Congratulations. You have administrator rights</h1>
            <ul class="jobs">
            <li><pfx:button normalclass="editor_submit" page="editorusermanager">Useradmin</pfx:button></li>
            <li>
              <ixsl:choose>
                <ixsl:when test="/formresult/cr_editorsession/@loginallowed = &apos;true&apos;">
                  <pfx:button mode="force" normalclass="editor_submit" page="prodselect" target="_top">
                    <pfx:command name="SELWRP">login</pfx:command>
                    <pfx:argument name="login.LoginAllowed">false</pfx:argument>Prohibit new logins</pfx:button>
                </ixsl:when>
                <ixsl:otherwise>
                  <pfx:button mode="force" normalclass="editor_submit" page="prodselect" target="_top">
                    <pfx:command name="SELWRP">login</pfx:command>
                    <pfx:argument name="login.LoginAllowed">true</pfx:argument>Allow new logins</pfx:button>
                </ixsl:otherwise>
              </ixsl:choose>
            </li>
            </ul>
          </div>
        </ixsl:if>
      </lang>
    </product>
  </part>
  
</include_parts>
