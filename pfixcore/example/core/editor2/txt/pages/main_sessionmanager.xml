<?xml version="1.0" encoding="ISO-8859-1"?>
<include_parts xmlns:pfx="http://www.schlund.de/pustefix/core"
               xmlns:ixsl="http://www.w3.org/1999/XSL/Transform">
  
  <part name="logoutbutton">
    <product name="default">
      <lang name="default">
        <pfx:button target="_top" mode="force" page="start">Cancel</pfx:button>
      </lang>
    </product>
  </part>

  <part name="content">
    <product name="default">
      <lang name="default">
        <center>
          <br/>
          <table width="90%">
            <tr>
              <td>
                <span style="color: #ffffff; font-weight: bold;">Currently running sessions:</span>
              </td>
            </tr>
            <tr>
              <td align="center">
                <pfx:include part="displayallsessions"/>
              </td>
            </tr>
          </table>
        </center>
      </lang>
    </product>
  </part>
  
  <part name="displayallsessions">
    <product name="default">
      <lang name="default">
        <table class="editor_box" cellspacing="0" width="100%" style="padding:0px;">
          <tr>
            <td class="editor_head">
              <b>SessionId</b>
            </td>
            <td class="editor_head">
              <b>Creation time</b>
            </td>
            <td class="editor_head">
              <b>Last Access</b>
            </td>
            <td class="editor_head">
              <b>No. of Req.</b>
            </td>
            <td class="editor_head">
              <b>Editor user</b>
            </td>
          </tr>
          <ixsl:for-each select="/formresult/sessioninfo/session">
            <ixsl:variable name="class">
              <ixsl:choose>
                <ixsl:when test="(count(preceding-sibling::session) mod 2) = 0">editor_even_row</ixsl:when>
                <ixsl:otherwise>editor_odd_row</ixsl:otherwise>
              </ixsl:choose>
            </ixsl:variable>
            <tr>
              <ixsl:attribute name="class"><ixsl:value-of select="$class"/></ixsl:attribute>
              <td style="padding:1px;" nowrap="nowrap">
                <ixsl:value-of select="./@id"/>
              </td>
              <td style="padding:1px;" nowrap="nowrap">
                <ixsl:value-of select="./@created"/>
              </td>
              <td style="padding:1px;" nowrap="nowrap">
                <ixsl:value-of select="./@lastAccess"/>
              </td>
              <td style="padding:1px;" nowrap="nowrap">
                <ixsl:value-of select="./@requestCount"/>
              </td>
              <td style="padding:1px;" nowrap="nowrap">
                <ixsl:choose>
                  <ixsl:when test="./@username">
                    <ixsl:value-of select="./@username"/>
                    (<ixsl:value-of select="./@userfullname"/>, Phone: <ixsl:value-of select="./@userphone"/>)
                  </ixsl:when>
                  <ixsl:otherwise>
                    <i>not logged in</i>
                  </ixsl:otherwise>
                </ixsl:choose>
              </td>
            </tr>
            <tr style="padding:0px;">
              <ixsl:attribute name="class"><ixsl:value-of select="$class"/></ixsl:attribute>
              <td colspan="6" style="padding:1px;" class="editor_small">
                <ixsl:for-each select="./step">
                  <ixsl:if test="not(position() = 1)"> -> </ixsl:if>
                  <ixsl:value-of select="@stylesheet"/>
                  <ixsl:if test="not(@counter = '1')">(<ixsl:value-of select="@counter"/>)</ixsl:if>
                </ixsl:for-each>
              </td>
            </tr>
            <ixsl:if test="./@incpart">
              <tr>
                <td style="padding-right:10px; color: #993333; text-align: right;" colspan="5">
                  Currently working on: <ixsl:value-of select="./@incpart"/>
                </td>
              </tr>
            </ixsl:if>
          </ixsl:for-each>
          <tr>
            <td colspan="5">
              <hr/>
            </td>
          </tr>
          <tr>
            <td style="padding: 5px;" colspan="5" align="right">
              <pfx:button page="sessionmanager" normalclass="editor_submit" mode="force">Update</pfx:button>
            </td>
          </tr>
        </table>
      </lang>
    </product>
  </part>
    
</include_parts>
